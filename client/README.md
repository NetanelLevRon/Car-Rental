# Car Rental
***
### client side 
&#x202b; האתר מתחיל ב - app.component שמכיל ב  - html שלושה דפים:   
```html
    <header>
        <app-header></app-header>
    </header>
    <main>
            <app-main></app-main> 
    </main>
    <footer>
        <app-footer></app-footer>
    </footer>
```
&#x202b; ה - header ןה- footer סטאטיים וה-main דינאמי.
## (main.component) app-main
&#x202b; מכיל תגית אחת - router-outlet ותצוגתו דינאמית ומשתנה ומכילה את כל שאר דפי האתר ע"י סרגל הניווט שב - header   (header.component) וקומפוננטות chid מתוך הדפים.
&#x202b; כל הניווט באתר מורשה או נחסם לגישה בהתאם לתפקיד הלקוח (user role) ע"י guards (auth.guard.ts).
## בכניסה לאתר
&#x202b; בדף הבית ישנה אפשרות ליצור קשר עם האתר, בכדי לאפשר זאת יש לגשת לצד השרת, ב - UIL - בתקיית ה -Controllers, ב- EmailControler שורה 30 ב- client.Credentials (דוגמא למטה) יש להכניס את כתובת ה המייל שתקבל את המייל מהאתר, (של gmail) ואת הסיסמה (ניבדק אצלי ועובד).
```csharp
client.UseDefaultCredentials = false;
client.Credentials = new NetworkCredential("yourEmail@gmail.com", "your password"); // the sender email address & sender password
client.EnableSsl = true; // to encrypt the connection
```
&#x202b; ןבצד הלקוח ב - app, בתיקיית shared, modles, email.model, יש להכניס את אותה כתובת מייל למשתנה tomail (דוגמה למטה).
```typeScript
public senderMail: string; // from = the sender mail
public tomail: string = "yourMail@gmail.com"; // to = the recipient email
public subject: string;
public message: string;
```
&#x202b; ולבסוף יש להפעיל את אפשרות 'גישה לאפליקציות ברמת אבטחה נמוכה' מחשבון ה-google של כתובת המייל בכתובת שלמטה:
https://myaccount.google.com/u/2/lesssecureapps?pli=1&rapt=AEjHL4OfHYDM1eA_WtDStCbYY6w5icyzfDuahYnXJQHC2J50pOYVcRTlRYyTpMwbGWAfXZX1hMlfyrycfh4pHvR-urnb1eiQag
***
&#x202b; בנחיתה לדף הבית, הקומפוננטה קוראת לאתחל את כל המידע הרלוואנטי לאתר כ -guest (רק בכניסה הראשונה ולאחר logout של מנהל בכדי לייבא מחדש את ה - data לאחר שנעשו שינויים) ע"י השירות מ - fullCarService כך שבלחיצה על כפתור ה - cars בסרגל הניווט כל המידע כבר יהיה מוכן לתצוגה.
*  fullCarService (fullCar.service.ts)
&#x202b; עושה שימוש ב 4 סרוויסים ומשמש למשיכת המידע מ 4 טבלאות בדטא בייס שבצד השרת ולריכוז הנתונים תחת מודל של רכב אחד מלא (fullCar.model.ts).
&#x202b; הצורך עלה כיוון שבהצגת כל כרטיס של רכב, בכל מקום באפליקציה, נעשה שימוש בנתונים מיותר מטבלה אחת ולכן המידע מרוכז להקלה על זמן ריצה, קוד חוזר ולוגיקה מיותרת.
&#x202b; בנוסף על הפונקציות המשמשות לרוב למטרה הנ"ל ישנה פונקציה (setAvailabilityCarsInDB) שמופעלת, בין היתר, גם ע"י שעון דינאמי שבודק אם תאריך של שכירות לרכב שהוזמן לעתיד כבר הגיע,  ומעדכנת את זמינותו בצד השרת ובצד הלקוח.
* cars (cars.component)
&#x202b; מכיל את כל הרכבים הזמינים לתצוגה (בקובץ ה- ts ישנה אפשרות להציג את כלל הרכבים ולא רק את הזמינים. הערה ניתנה בקובץ cars.component.ts שורות 51 ו-57 ) מתוך פורמט ה -fullCar בתוך משתנה - fullCarList לצורך פילטור והצגת הרכבים עם הנתונים הרלוואנטים.
&#x202b; בלחיצה על כרטיס רכב, נקראת הפונקציה - setCarsToLocalStorage לצורך שמירת הרכב כרכב שהמשתמש התעניין בו לתצוגה בתחתית הדף (ובכל logout או כניסה מחודשת הוא מתאפס) וחלק מהדף (החלק של תצוגת הרכבים) מתחלף לcar-details (ע"י roter-outlet) והרכב מועבר אליו ע"י הפונקציה pastCurrentCar דרך 'click event' ב- html.
* car-details (car-preview.component)
&#x202b; במצב לקוח לא רשום (guest), מכילה את פרטי הרכב וכפתור אחד למעבר לקומפוננטה לחישוב דמי השכירות והצגת התאריכים בהם הרכב זמין (car-price). ובמצב משתמש רשום (customer) ישנו כפתור נוסף לביצוע הזמנה.
* car-price & car-order
&#x202b; מכילים אפשרות לחישוב דמי השכירות (ב- car-price באופן ישיר וב - car-order לאחר ביצוע הזמנה) בהשמת תאריכים רצויים להשכרה באופן שלא ניתן לבחור בתאריכים תפוסים ע"י הפונקציות   insertRelevantOrder, dateValidation ו- validateOnFutureOrders (הסבר מלא ניתן בקובצי ה- ts).
&#x202b; ביצוע הזמנה (ב- car-order)  נעשית דרך שירות ה- order.service ונשלחת לשרת יחד עם שם משתמש וסיסמה לצורך הרשאת הגישה כ - customer - לקוח רשום.
## &#x202b; משתמש רשום (customer)
&#x202b; ישנו כפתור נוסף, בסרגל הניווט, שבלחיצה עליו ה- main מתחלף ל (my-order) order-list.component שמציג את היסטורית ההזמנות של המשתמש תחת הקטגוריות: past-orders - רכבים בשכירות או שהושכרו בעבר ו- future orders - רכבים שהוזמנו לתאריך עתידי. וזה נעשה ע"י שימוש בפונקציה רקורסיבית - setOrdersFromLastToNew שממיינת את ההזמנות לשני משתנים. אחד - להצגת ההזמנות הנוכחיות ושעברו, והשני - להזמנות עתידיות (בסדר עולה עד התאריך העתידי).
## &#x202b; עובד חברה (employee)
&#x202b; ישנו דף אחד בסרגל הניווט (מלבד ה - logout ןה - home) להחזרת רכב מהשכרה ע"י מספר הרכב. פונה ל - getCarByLicense ולאחר ולידציה בסיסית הפונקציה פונה  ל לשירות ה - carService לפונקציה getCarByLicensePlate יחד עם שם משתמש וסיסמה להרשאת גישה כ employee שמביאה את הרכב הנוכחי.
&#x202b; יחד עם נתוני הרכב הנוכחי, ניקראת הפונקציה setCar ותפקידה להביא את הזמנת השכירות על הרכב משירות ה- orderService לצורך עריכת ההזמנה ואת סוג הרכב (carType) משירות ה - carTypeService לצורך חישוב העלות הכולל של ההשכרה והצגתו. לאחר שהכל עבר בהצלחה נשלחת ההזמנה דרך ה - editOrder שב - orderService לדטא בייס יחד עם actualRentalEnd מעודכן לתאריך הנוכחי.
## &#x202b; מנהל (admin)
&#x202b; בכל הדפים קיימת אפשרות של עריכת הנתונים ומחיקת הכרטיס. אפשר לערוך מבלי שהשינויים ישמרו לאחר חזרה ממצב עריכה (ע"י הכפתור back במקום save) וזה נעשה ע"י הפונקציה edit (בכל קומפוננטות המנהל) שמקבלת משתנה בשם from לצורך אינדיקציה מאיזה כפתור הוא נשלח (edit או back) והפעלה בהתאם.
&#x202b; ישנה חזרה על שמות המשתנים של הנתונים המופיעים בתצוגה (כל ה -properties של ה - classes user, order, car ן- carType בהתאם לדף) לצורך עריכה ולצורך פילטור. הצור עלה כדי שבלחיצה על עריכה (edit) יופיעו הערכים הנוכחיים, שלפני העריכה, וכל שינוי שנעשה איתם לא ישמר (אלא במשתנים הנ"ל) כך שאם הלקוח לא ירצה לשמור את השינויים (ע"י save) בלחיצה על back הנתונים הקודמים ישארו ללא כל שינוי. ולבסוף הם אלא שישלחו לשרת (אם הלקוח ילחץ על save).
&#x202b; והמשתנים לצורך פילטור, ששוים בשמם למתשני המחחלקה, בכדי לשלוח אותם לצורך חיפוש, וכמובן, מבלי שיהיה אפקט על המשתנים לצורך עריכה.
&#x202b; ב - user-managment בפונקציה edit בלחיצה על back ישנה בדיקה נוספת לוידוא אם הת"ז וה - userName עברו בצד השרת, ואם לא, הנתונים הקודמים יחזרו (הסבר מפורט מופיע בקובץ ה - ts שורות 157 ו- 162).

*** 
* &#x202b; השתדלתי לתת רקע כללי ולהתמקד רק במקרים יוצאי הדופן. הסבר מפורט יותר ניתן בהערות לצד הקוד ולפעמים בדוקומנטציה על הפונקציה עצמה.
* &#x202b; כל ההערות בפרוייקט נכתבו באנגלית בכדי לאפשר את הגשתו והצגתו לפני קהל מעסיקים שיכולת זו רלוונטית עבורם.
* &#x202b; עיצוב האתר הינו רספונסיבי ומתאים לכלל סוגי המכשירים (פלאפון - מאונך ומאוזן, טאבלט ומחשב) .
* &#x202b; רוב העיצוב נעשה ע"י css ומעט מאד בעזרת bootstrap 3.3.7